(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{124:function(e,t){},127:function(e,t,a){},128:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(56),l=a.n(o),c=a(9),s=a(57),m=a(12),i=a(3),u=a.n(i),p=a(11),g=a(7),f=a(24),d=a.n(f);function h(e){return d.a.defaults.headers.common.Authorization||b(localStorage.token),new Promise(function(t,a){d()({url:"/graphql",method:"post",data:{query:"\n        ".concat(e,"\n        ")}}).then(function(e){t(e.data)}).catch(function(e){return a(e)})})}function b(e){d.a.defaults.headers.common.Authorization="Bearer ".concat(e)}var E=a(23),v=a.n(E),y=a(14),w=a.n(y),x=a(5),O=a.n(x),j=function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),o=a[0],l=a[1],s=Object(n.useState)(""),m=Object(g.a)(s,2),i=m[0],f=m[1];function d(){return(d=Object(p.a)(u.a.mark(function t(a){var n,r;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,h('\n      mutation {\n        login(email: "'.concat(o,'", password: "').concat(i,'") {\n          email,\n          token\n        }\n        }\n      '));case 4:(n=t.sent).errors?(r=n.errors[0].message,f(""),alert(r)):(localStorage.setItem("token",n.data.login.token),b(n.data.login.token),e.history.push("/lobby")),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),"That email is not registered to any user",alert("That email is not registered to any user");case 12:case"end":return t.stop()}},t,null,[[1,8]])}))).apply(this,arguments)}return r.a.createElement("div",{className:O.a.layout},r.a.createElement("img",{src:w.a,alt:"MessageApp's logo",style:{margin:"1.25rem",marginLeft:"4rem"}}),r.a.createElement("img",{src:v.a,alt:"MessageApp's icon"}),r.a.createElement("form",{onSubmit:function(e){return d.apply(this,arguments)},className:O.a.Form,autoComplete:"off"},r.a.createElement("button",{type:"submit"},"Login"),r.a.createElement("div",{className:O.a.formGroup},r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",value:o,onChange:function(e){return l(e.target.value)},name:"email"})),r.a.createElement("div",{className:O.a.formGroup},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("br",null),r.a.createElement("input",{type:"password",value:i,onChange:function(e){return f(e.target.value)},name:"password"}))),r.a.createElement("p",null,"Or ",r.a.createElement(c.b,{to:"/auth/signup"},"Sign Up")))},S=function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),o=a[0],l=a[1],s=Object(n.useState)(""),m=Object(g.a)(s,2),i=m[0],f=m[1],d=Object(n.useState)(""),E=Object(g.a)(d,2),y=E[0],x=E[1],j=Object(n.useState)(""),S=Object(g.a)(j,2),k=S[0],N=S[1],_=Object(n.useState)(""),A=Object(g.a)(_,2),C=A[0],F=A[1];function U(){return(U=Object(p.a)(u.a.mark(function t(a){var n,r;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,h('\n      mutation {\n        createUser(email: "'.concat(i,'", username: "').concat(o,'", \n                   profileImageUrl: "').concat(y,'" password: "').concat(k,'") {\n          email,\n          username,\n          profileImageUrl,\n          token\n        }\n        }\n      '));case 4:(n=t.sent).errors?(r=n.errors[0].message,N(""),F(""),alert(r)):(localStorage.setItem("token",n.data.createUser.token),b(n.data.createUser.token),e.history.push("/lobby")),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),"That email is already registered",alert("That email is already registered");case 12:case"end":return t.stop()}},t,null,[[1,8]])}))).apply(this,arguments)}return r.a.createElement("div",{className:O.a.layout},r.a.createElement("img",{src:w.a,alt:"MessageApp's logo",style:{margin:"1.25rem",marginLeft:"4rem"}}),r.a.createElement("img",{src:v.a,alt:"MessageApp's icon"}),r.a.createElement("form",{onSubmit:function(e){return U.apply(this,arguments)},className:O.a.Form,autoComplete:"off"},r.a.createElement("button",{type:"submit"},"Sign Up"),r.a.createElement("div",{className:O.a.formGroup},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",value:o,onChange:function(e){return l(e.target.value)},name:"email"})),r.a.createElement("div",{className:O.a.formGroup},r.a.createElement("label",{htmlFor:"username"},"Email"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",value:i,onChange:function(e){return f(e.target.value)},name:"email"})),r.a.createElement("div",{className:O.a.formGroup},r.a.createElement("label",{htmlFor:"profileImageUrl"},"Profile Image Url"),r.a.createElement("br",null),r.a.createElement("input",{type:"text",value:y,onChange:function(e){return x(e.target.value)},name:"profileImageUrl"})),r.a.createElement("div",{className:O.a.formGroup},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("br",null),r.a.createElement("input",{type:"password",value:k,onChange:function(e){return N(e.target.value)},name:"password"})),r.a.createElement("div",{className:O.a.formGroup},r.a.createElement("label",{htmlFor:"confirm-password"},"Confirm Password"),r.a.createElement("br",null),r.a.createElement("input",{type:"password",value:C,onChange:function(e){return F(e.target.value)},name:"confirm-password"}))),r.a.createElement("p",null,"Already a user? ",r.a.createElement(c.b,{to:"/auth/login"},"Login")))},k=a(60),N=a.n(k),_=function(e){var t=e.ProtectedComponent;return r.a.createElement(m.d,null,r.a.createElement(A,{exact:!0,path:["/lobby","/"],component:t}),r.a.createElement(m.b,{exact:!0,path:["/auth/login","/auth/signup"],component:C}),r.a.createElement(F,null))};function A(e){var t=e.component,a=Object(s.a)(e,["component"]);return r.a.createElement(m.b,Object.assign({},a,{render:function(e){return U()?r.a.createElement(t,e):r.a.createElement(m.a,{to:{pathname:"/auth/login",state:{from:e.location}}})}}))}var C=function(){return r.a.createElement(m.d,null,U()?r.a.createElement(m.a,{to:"/lobby"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(m.b,{exact:!0,path:"/auth/login",component:j}),r.a.createElement(m.b,{exact:!0,path:"/auth/signup",component:S})))},F=function(e){return r.a.createElement("div",null,r.a.createElement("h1",null,"Page does not exist"),r.a.createElement(c.b,{to:"/lobby"},"Go back"))};function U(){try{var e=localStorage.token;return!!N()(e)}catch(t){return localStorage.clear(),!1}}var I=a(61),L=a(62),G=a(66),M=a(63),D=a(67),T=a(64),P=a.n(T),B=a(16),W=a.n(B),q=a(65),z=a.n(q)()("/"),H=function(){return r.a.createElement(m.b,{exact:!0,path:["/lobby","/"]},r.a.createElement("div",{className:W.a.header},r.a.createElement("img",{src:w.a,alt:"MessageApp's logo"}),r.a.createElement("button",{onClick:function(){localStorage.clear(),window.location.href="/auth/login"}},"Sign Out")),r.a.createElement(J,null),r.a.createElement($,null))},J=function(e){function t(e){var a;return Object(I.a)(this,t),(a=Object(G.a)(this,Object(M.a)(t).call(this,e))).state={messages:[]},z.on("NEW_MESSAGE",function(e){a.setState({messages:a.state.messages.slice().concat(e)});var t=document.getElementById("msgList");t.scrollTop=t.scrollHeight+t.clientHeight}),a}return Object(D.a)(t,e),Object(L.a)(t,[{key:"componentDidMount",value:function(){var e=Object(p.a)(u.a.mark(function e(){var t,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.messages.length){e.next=5;break}return e.next=3,V();case 3:(t=e.sent)&&(this.setState({messages:this.state.messages.slice().concat(t)}),(a=document.getElementById("msgList"))&&(a.scrollTop=a.scrollHeight+a.clientHeight));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.messages.map(function(e){return r.a.createElement(K,Object.assign({key:e._id},e))});return r.a.createElement("ul",{className:W.a.messageFeed,id:"msgList"},e.length?e:r.a.createElement("div",{className:W.a.loading},r.a.createElement("div",{className:"mesh-loader"},r.a.createElement("div",{className:"set-one"},r.a.createElement("div",{className:"circle"}),r.a.createElement("div",{className:"circle"})),r.a.createElement("div",{className:"set-two"},r.a.createElement("div",{className:"circle"}),r.a.createElement("div",{className:"circle"})))))}}]),t}(r.a.Component),K=function(e){var t=e.content,a=e.author,n=e.createdAt;return r.a.createElement("li",null,r.a.createElement("div",{style:{display:"flex",flexDirection:"column",margin:"0 0.5rem"}},r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start"}},r.a.createElement("img",{src:a.profileImageUrl,alt:"profile image of "+a.username,onError:function(e){e.target.onerror=null,e.target.src="https://cdn.pixabay.com/photo/2014/04/03/10/32/businessman-310819_1280.png"}}),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",marginLeft:"0.5rem",justifyContent:"flex-start"}},r.a.createElement("p",{style:{color:"#2A81D8",fontSize:"18px",fontWeight:400,letterSpacing:"2px",position:"relative",bottom:"10px"}},a.username),r.a.createElement(P.a,{fromNow:!0,style:{position:"relative",bottom:"25px"}},+n||n))),r.a.createElement("p",{style:{fontWeight:200,fontSize:"18px",position:"relative",bottom:"25px",letterSpacing:"1.25px"}},t)))};function V(){return X.apply(this,arguments)}function X(){return(X=Object(p.a)(u.a.mark(function e(){var t,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h('\n      query {\n        messages(sortByCreatedAt: "asc") {\n          _id,\n          content,\n          createdAt,\n          author {\n            username,\n            profileImageUrl\n          }\n        }\n      }\n    ');case 3:return(t=e.sent).errors&&"Unauthenticated request"===t.errors[0].message&&(localStorage.clear(),window.location.href="/auth/login"),a=t.data.messages,e.abrupt("return",a);case 9:return e.prev=9,e.t0=e.catch(0),console.log("There was a problem loading messages"),e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}var $=function(){var e=Object(n.useState)(""),t=Object(g.a)(e,2),a=t[0],o=t[1],l=function(e){e.preventDefault(),function(e){Q.apply(this,arguments)}(a),o("")};return r.a.createElement("form",{onSubmit:l,className:W.a.messageForm},r.a.createElement("textarea",{placeholder:"Enter a message",onChange:function(e){return o(e.target.value)},value:a,onKeyDown:function(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),l(e))}}))};function Q(){return(Q=Object(p.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h('\n      mutation {\n        createMessage(content: "'.concat(t,'") {\n          content,\n          createdAt,\n          author {\n            username,\n            profileImageUrl\n          }\n        }\n      }\n    '));case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e.catch(0),console.log("There was a problem loading messages"),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}a(127);var R=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(c.a,null,r.a.createElement(_,{ProtectedComponent:H})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},14:function(e,t,a){e.exports=a.p+"static/media/MessageApp-logo.5f5a2b93.svg"},16:function(e,t,a){e.exports={header:"Lobby_header__-IAXo",messageFeed:"Lobby_messageFeed__2TfOo",messageForm:"Lobby_messageForm__33eMV",loading:"Lobby_loading__3Cxy3"}},23:function(e,t,a){e.exports=a.p+"static/media/MessageApp-icon.f23c8f11.svg"},5:function(e,t,a){e.exports={layout:"Auth_layout__2Nl-I",formGroup:"Auth_formGroup__2W3La",Form:"Auth_Form__2NqU9"}},68:function(e,t,a){e.exports=a(128)}},[[68,1,2]]]);
//# sourceMappingURL=main.592356cd.chunk.js.map